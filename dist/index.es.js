import{__generator as e,__assign as r}from"tslib";import t from"axios";function a(e){return new Promise(function(r,t){function a(n,u){try{var o=e[u?"throw":"next"](n)}catch(e){return void t(e)}o.done?r(o.value):Promise.resolve(o.value).then(a,s)}function s(e){a(e,1)}a()})}var s=function(e){return e&&e.data&&e.data.response},n=function(n,u){return a(function(){var a,o,c,i;return e(this,function(e){switch(e.label){case 0:a=0,e.label=1;case 1:return e.trys.push([1,3,,4]),o=r({},n.parameters,{start:0,rows:1,fields:"alt_img","p-id":'categoryPathId:"'+n.categoryPathL2+">"+u+'"'}),[4,t.get(n.unbxdBase+"/category",{headers:n.headers,params:o})];case 2:return c=e.sent(),a=s(c)&&s(c).numberOfProducts||0,[3,4];case 3:return i=e.sent(),[2,Promise.reject(i)];case 4:return[2,Promise.resolve(a)]}})}())},u=function(u){return new Promise(function(o,c){return a(function(){var a,i,l,d,p,f,h,m,b,g,v,y,w,P,x,B,I,L;return e(this,function(e){switch(e.label){case 0:e.trys.push([0,7,,8]),i=u.parameters,l=i.start,d=i.rows,p=l+d,f=0,h=null,m=!1,b=0,g=0,v=d,y=0,w=u.categoryIdsL3,e.label=1;case 1:return y<w.length?(P=w[y],[4,n(u,P)]):[3,6];case 2:return(x=e.sent())+f>l?(b=0,m?g=x<v?x:v:(f=x-(g=x-(b=x-(x+f-l))<v?x-b:v)-b,m=!0),[4,t.get(u.unbxdBase+"/category",{headers:u.headers,params:r({},u.parameters,{start:b,rows:g})})]):[3,4];case 3:B=e.sent(),h?(I=s(h),(a=I.products).push.apply(a,B.data.response.products)):h=B,v-=g,e.label=4;case 4:if((f+=x)>=p)return[3,6];e.label=5;case 5:return y++,[3,1];case 6:return o(h),[3,8];case 7:return L=e.sent(),c(L),[3,8];case 8:return[2]}})}())})};export default u;export{u as fetchL3Categories};
